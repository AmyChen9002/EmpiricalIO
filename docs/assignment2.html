<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 5 Assignment 2: Production Function Estimation | ECON 6120I Topics in Empirical Industrial Organization</title>
  <meta name="description" content="Thie is a lecture note for ECON6120I at Hong Kong University of Science and Technology.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 5 Assignment 2: Production Function Estimation | ECON 6120I Topics in Empirical Industrial Organization />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Thie is a lecture note for ECON6120I at Hong Kong University of Science and Technology." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Assignment 2: Production Function Estimation | ECON 6120I Topics in Empirical Industrial Organization />
  
  <meta name="twitter:description" content="Thie is a lecture note for ECON6120I at Hong Kong University of Science and Technology." />
  

<meta name="author" content="Kohei Kawaguchi">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="assignment1.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECON6120I</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#general-information"><i class="fa fa-check"></i><b>1.2</b> General Information</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#class-time"><i class="fa fa-check"></i><b>1.2.1</b> Class Time</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>1.2.2</b> Description</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#expectation-and-goals"><i class="fa fa-check"></i><b>1.2.3</b> Expectation and Goals</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#required-environment"><i class="fa fa-check"></i><b>1.3</b> Required Environment</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#evaluation"><i class="fa fa-check"></i><b>1.4</b> Evaluation</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#academic-integrity"><i class="fa fa-check"></i><b>1.5</b> Academic Integrity</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.6</b> Schedule</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#course-materials"><i class="fa fa-check"></i><b>1.7</b> Course Materials</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.7.1</b> R and RStudio</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#handbook-chapters"><i class="fa fa-check"></i><b>1.7.2</b> Handbook Chapters</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i><b>1.7.3</b> Books</a></li>
<li class="chapter" data-level="1.7.4" data-path="index.html"><a href="index.html#papers"><i class="fa fa-check"></i><b>1.7.4</b> Papers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#structural-estimation-and-counterfactual-analysis"><i class="fa fa-check"></i><b>2.1</b> Structural Estimation and Counterfactual Analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#recap"><i class="fa fa-check"></i><b>2.1.2</b> Recap</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#historical-remark"><i class="fa fa-check"></i><b>2.1.3</b> Historical Remark</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#setting-up-the-environment"><i class="fa fa-check"></i><b>2.2</b> Setting Up The Environment</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#rstudio-project"><i class="fa fa-check"></i><b>2.2.1</b> RStudio Project</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#basic-programming-in-r"><i class="fa fa-check"></i><b>2.2.2</b> Basic Programming in R</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#reproducible-reports-using-rmarkdown"><i class="fa fa-check"></i><b>2.2.3</b> Reproducible Reports using Rmarkdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="production.html"><a href="production.html"><i class="fa fa-check"></i><b>3</b> Production and Cost Function Estimation</a><ul>
<li class="chapter" data-level="3.1" data-path="production.html"><a href="production.html#motivations"><i class="fa fa-check"></i><b>3.1</b> Motivations</a><ul>
<li class="chapter" data-level="3.1.1" data-path="production.html"><a href="production.html#io"><i class="fa fa-check"></i><b>3.1.1</b> IO</a></li>
<li class="chapter" data-level="3.1.2" data-path="production.html"><a href="production.html#development"><i class="fa fa-check"></i><b>3.1.2</b> Development</a></li>
<li class="chapter" data-level="3.1.3" data-path="production.html"><a href="production.html#trade"><i class="fa fa-check"></i><b>3.1.3</b> Trade</a></li>
<li class="chapter" data-level="3.1.4" data-path="production.html"><a href="production.html#management"><i class="fa fa-check"></i><b>3.1.4</b> Management</a></li>
<li class="chapter" data-level="3.1.5" data-path="production.html"><a href="production.html#education"><i class="fa fa-check"></i><b>3.1.5</b> Education</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="production.html"><a href="production.html#analyzing-producer-behaviors"><i class="fa fa-check"></i><b>3.2</b> Analyzing Producer Behaviors</a></li>
<li class="chapter" data-level="3.3" data-path="production.html"><a href="production.html#production-function-estimation"><i class="fa fa-check"></i><b>3.3</b> Production Function Estimation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="production.html"><a href="production.html#cobb-douglas-specification-as-a-benchmark"><i class="fa fa-check"></i><b>3.3.1</b> Cobb-Douglas Specification as a Benchmark</a></li>
<li class="chapter" data-level="3.3.2" data-path="production.html"><a href="production.html#potential-bias-i-endogeneity"><i class="fa fa-check"></i><b>3.3.2</b> Potential Bias I: Endogeneity</a></li>
<li class="chapter" data-level="3.3.3" data-path="production.html"><a href="production.html#potential-bias-ii-selection"><i class="fa fa-check"></i><b>3.3.3</b> Potential Bias II: Selection</a></li>
<li class="chapter" data-level="3.3.4" data-path="production.html"><a href="production.html#how-to-resolve-endogeneity-bias"><i class="fa fa-check"></i><b>3.3.4</b> How to Resolve Endogeneity Bias?</a></li>
<li class="chapter" data-level="3.3.5" data-path="production.html"><a href="production.html#panel-data"><i class="fa fa-check"></i><b>3.3.5</b> Panel Data</a></li>
<li class="chapter" data-level="3.3.6" data-path="production.html"><a href="production.html#first-order-condition-for-inputs"><i class="fa fa-check"></i><b>3.3.6</b> First-Order Condition for Inputs</a></li>
<li class="chapter" data-level="3.3.7" data-path="production.html"><a href="production.html#productioniv"><i class="fa fa-check"></i><b>3.3.7</b> Instrumental Variable</a></li>
<li class="chapter" data-level="3.3.8" data-path="production.html"><a href="production.html#olley-pakes-approach"><i class="fa fa-check"></i><b>3.3.8</b> Olley-Pakes Approach</a></li>
<li class="chapter" data-level="3.3.9" data-path="production.html"><a href="production.html#assumption-i-information-set"><i class="fa fa-check"></i><b>3.3.9</b> Assumption I: Information Set</a></li>
<li class="chapter" data-level="3.3.10" data-path="production.html"><a href="production.html#assumption-ii-first-order-markov"><i class="fa fa-check"></i><b>3.3.10</b> Assumption II: First Order Markov</a></li>
<li class="chapter" data-level="3.3.11" data-path="production.html"><a href="production.html#assumption-iii-timing-of-input-choices"><i class="fa fa-check"></i><b>3.3.11</b> Assumption III: Timing of Input Choices</a></li>
<li class="chapter" data-level="3.3.12" data-path="production.html"><a href="production.html#assumption-iv-scalar-unobservable"><i class="fa fa-check"></i><b>3.3.12</b> Assumption IV: Scalar Unobservable</a></li>
<li class="chapter" data-level="3.3.13" data-path="production.html"><a href="production.html#assumption-iv-strict-monotonicity"><i class="fa fa-check"></i><b>3.3.13</b> Assumption IV: Strict Monotonicity</a></li>
<li class="chapter" data-level="3.3.14" data-path="production.html"><a href="production.html#two-step-approach-the-first-step"><i class="fa fa-check"></i><b>3.3.14</b> Two-step Approach: The First Step</a></li>
<li class="chapter" data-level="3.3.15" data-path="production.html"><a href="production.html#two-step-approach-the-second-step"><i class="fa fa-check"></i><b>3.3.15</b> Two-step Approach: The Second Step</a></li>
<li class="chapter" data-level="3.3.16" data-path="production.html"><a href="production.html#identification-of-the-anticipated-shocks"><i class="fa fa-check"></i><b>3.3.16</b> Identification of the Anticipated Shocks</a></li>
<li class="chapter" data-level="3.3.17" data-path="production.html"><a href="production.html#two-step-estimation-of-olley1996."><i class="fa fa-check"></i><b>3.3.17</b> Two-Step Estimation of <span class="citation">Olley &amp; Pakes (<a href="#ref-Olley1996">1996</a>)</span>.</a></li>
<li class="chapter" data-level="3.3.18" data-path="production.html"><a href="production.html#from-an-economic-models-to-an-econometric-model"><i class="fa fa-check"></i><b>3.3.18</b> From An Economic Models to An Econometric Model</a></li>
<li class="chapter" data-level="3.3.19" data-path="production.html"><a href="production.html#how-to-resolve-selection-bias"><i class="fa fa-check"></i><b>3.3.19</b> How to Resolve Selection Bias</a></li>
<li class="chapter" data-level="3.3.20" data-path="production.html"><a href="production.html#correction-in-the-first-step"><i class="fa fa-check"></i><b>3.3.20</b> Correction in the First Step</a></li>
<li class="chapter" data-level="3.3.21" data-path="production.html"><a href="production.html#correction-in-the-second-step-i-the-source-of-bias"><i class="fa fa-check"></i><b>3.3.21</b> Correction in the Second Step I: The Source of Bias</a></li>
<li class="chapter" data-level="3.3.22" data-path="production.html"><a href="production.html#correction-in-the-second-step-ii-conditional-exit-probability"><i class="fa fa-check"></i><b>3.3.22</b> Correction in the Second Step II: Conditional Exit Probability</a></li>
<li class="chapter" data-level="3.3.23" data-path="production.html"><a href="production.html#correction-in-the-second-step-iii-invertibility-in-threshold"><i class="fa fa-check"></i><b>3.3.23</b> Correction in the Second Step III: Invertibility in Threshold</a></li>
<li class="chapter" data-level="3.3.24" data-path="production.html"><a href="production.html#correction-in-the-second-step-iv-controlling-the-threshold"><i class="fa fa-check"></i><b>3.3.24</b> Correction in the Second Step IV: Controlling the Threshold</a></li>
<li class="chapter" data-level="3.3.25" data-path="production.html"><a href="production.html#three-step-estimation-of-olley1996"><i class="fa fa-check"></i><b>3.3.25</b> Three Step Estimation of <span class="citation">Olley &amp; Pakes (<a href="#ref-Olley1996">1996</a>)</span></a></li>
<li class="chapter" data-level="3.3.26" data-path="production.html"><a href="production.html#zero-investment-problem"><i class="fa fa-check"></i><b>3.3.26</b> Zero Investment Problem</a></li>
<li class="chapter" data-level="3.3.27" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-i-discard-some-data"><i class="fa fa-check"></i><b>3.3.27</b> Tackle Zero Investment Problem I: Discard Some Data</a></li>
<li class="chapter" data-level="3.3.28" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-ii-use-another-proxy"><i class="fa fa-check"></i><b>3.3.28</b> Tackle Zero Investment Problem II: Use Another Proxy</a></li>
<li class="chapter" data-level="3.3.29" data-path="production.html"><a href="production.html#one-step-estimation-of-olley1996-and-levinsohn2003"><i class="fa fa-check"></i><b>3.3.29</b> One-step Estimation of <span class="citation">Olley &amp; Pakes (<a href="#ref-Olley1996">1996</a>)</span> and <span class="citation">Levinsohn &amp; Petrin (<a href="#ref-Levinsohn2003">2003</a>)</span></a></li>
<li class="chapter" data-level="3.3.30" data-path="production.html"><a href="production.html#scalar-unobservable-problem-finite-order-markov-process"><i class="fa fa-check"></i><b>3.3.30</b> Scalar Unobservable Problem: Finite-order Markov Process</a></li>
<li class="chapter" data-level="3.3.31" data-path="production.html"><a href="production.html#scalar-unobservable-problem-demand-and-productivity-shocks"><i class="fa fa-check"></i><b>3.3.31</b> Scalar Unobservable Problem: Demand and Productivity Shocks</a></li>
<li class="chapter" data-level="3.3.32" data-path="production.html"><a href="production.html#collinearity-problem"><i class="fa fa-check"></i><b>3.3.32</b> Collinearity Problem</a></li>
<li class="chapter" data-level="3.3.33" data-path="production.html"><a href="production.html#tackle-collinearity-problem-peculiar-assumptions"><i class="fa fa-check"></i><b>3.3.33</b> Tackle Collinearity Problem: Peculiar Assumptions</a></li>
<li class="chapter" data-level="3.3.34" data-path="production.html"><a href="production.html#tackle-collinearity-problem-share-regression"><i class="fa fa-check"></i><b>3.3.34</b> Tackle Collinearity Problem: Share Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="production.html"><a href="production.html#cost-function-estimation"><i class="fa fa-check"></i><b>3.4</b> Cost Function Estimation</a><ul>
<li class="chapter" data-level="3.4.1" data-path="production.html"><a href="production.html#cost-function-duality"><i class="fa fa-check"></i><b>3.4.1</b> Cost Function: Duality</a></li>
<li class="chapter" data-level="3.4.2" data-path="production.html"><a href="production.html#translog-cost-function"><i class="fa fa-check"></i><b>3.4.2</b> Translog Cost Function</a></li>
<li class="chapter" data-level="3.4.3" data-path="production.html"><a href="production.html#translog-cost-function-integrability"><i class="fa fa-check"></i><b>3.4.3</b> Translog Cost Function: Integrability</a></li>
<li class="chapter" data-level="3.4.4" data-path="production.html"><a href="production.html#two-approaches"><i class="fa fa-check"></i><b>3.4.4</b> Two Approaches</a></li>
<li class="chapter" data-level="3.4.5" data-path="production.html"><a href="production.html#cost-data-approach"><i class="fa fa-check"></i><b>3.4.5</b> Cost Data Approach</a></li>
<li class="chapter" data-level="3.4.6" data-path="production.html"><a href="production.html#revealed-preference-approach"><i class="fa fa-check"></i><b>3.4.6</b> Revealed Preference Approach</a></li>
<li class="chapter" data-level="3.4.7" data-path="production.html"><a href="production.html#single-product-monopolist"><i class="fa fa-check"></i><b>3.4.7</b> Single-product Monopolist</a></li>
<li class="chapter" data-level="3.4.8" data-path="production.html"><a href="production.html#unobserved-heterogeneity-in-the-cost-function"><i class="fa fa-check"></i><b>3.4.8</b> Unobserved Heterogeneity in the Cost Function</a></li>
<li class="chapter" data-level="3.4.9" data-path="production.html"><a href="production.html#multi-product-monopolist-case"><i class="fa fa-check"></i><b>3.4.9</b> Multi-product Monopolist Case</a></li>
<li class="chapter" data-level="3.4.10" data-path="production.html"><a href="production.html#oligopoly"><i class="fa fa-check"></i><b>3.4.10</b> Oligopoly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="assignment1.html"><a href="assignment1.html"><i class="fa fa-check"></i><b>4</b> Assignment 1: Basic Programming in R</a><ul>
<li class="chapter" data-level="4.1" data-path="assignment1.html"><a href="assignment1.html#simulate-data"><i class="fa fa-check"></i><b>4.1</b> Simulate data</a></li>
<li class="chapter" data-level="4.2" data-path="assignment1.html"><a href="assignment1.html#estimate-the-parameter"><i class="fa fa-check"></i><b>4.2</b> Estimate the parameter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="assignment2.html"><a href="assignment2.html"><i class="fa fa-check"></i><b>5</b> Assignment 2: Production Function Estimation</a><ul>
<li class="chapter" data-level="5.1" data-path="assignment2.html"><a href="assignment2.html#simulate-data-1"><i class="fa fa-check"></i><b>5.1</b> Simulate data</a></li>
<li class="chapter" data-level="5.2" data-path="assignment2.html"><a href="assignment2.html#estimate-the-parameters"><i class="fa fa-check"></i><b>5.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECON 6120I Topics in Empirical Industrial Organization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="assignment2" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Assignment 2: Production Function Estimation</h1>
<p>The deadline is the <strong>start time of February 25 class</strong>.</p>
<p>Report the following results in html format using R markdown. In other words, replicate this document. You write functions in a separate R file and put in <code>R</code> folder in the project folder. Build the project as a package and load it from the R markdown file. The execution code sholuld be written in R markdown file.</p>
<div id="simulate-data-1" class="section level2">
<h2><span class="header-section-number">5.1</span> Simulate data</h2>
<p>Consider the following production and investment process for <span class="math inline">\(j = 1, \cdots, 1000\)</span> firms across <span class="math inline">\(t = 1, \cdots, 10\)</span> periods.</p>
<p>The log production function is of the form: <span class="math display">\[
y_{jt} = \beta_0 + \beta_l l_{jt} + \beta_k k_{jt} + \omega_{jt} + \eta_{jt},
\]</span> where <span class="math inline">\(\omega_{jt}\)</span> is an anticipated shock and <span class="math inline">\(\eta_{jt}\)</span> is an ex post shock.</p>
<p>The anticipated shocks evolve as: <span class="math display">\[
\omega_{jt} = \alpha \omega_{j, t - 1} + \nu_{jt},
\]</span> where <span class="math inline">\(\nu_{jt}\)</span> is an i.i.d. normal random variable with mean 0 and standard deviation <span class="math inline">\(\sigma_\nu\)</span>. The ex post shock is an i.i.d. normal random variable with mean 0 and standard deviation <span class="math inline">\(\sigma_{\eta}\)</span>.</p>
<p>The product price the same across firms and normalized at 1. The price is normalized at 1. The wage <span class="math inline">\(w_t\)</span> is an i.i.d. exponential of normal random variable with mean 0 and standard deviation <span class="math inline">\(\sigma_{w}\)</span>.</p>
<p>Finally, the capital accumulate according to: <span class="math display">\[
K_{j, t + 1} = (1 - \delta) K_{jt} + I_{jt}.
\]</span></p>
<p>We set the parameters as follows:</p>
<table>
<thead>
<tr class="header">
<th>parameter</th>
<th>variable</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta_0\)</span></td>
<td><code>beta_0</code></td>
<td>1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_l\)</span></td>
<td><code>beta_l</code></td>
<td>0.2</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_k\)</span></td>
<td><code>beta_k</code></td>
<td>0.7</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\alpha\)</span></td>
<td><code>alpha</code></td>
<td>0.7</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma_{\eta}\)</span></td>
<td><code>sigma_eta</code></td>
<td>0.2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma_{\nu}\)</span></td>
<td><code>sigma_nu</code></td>
<td>0.5</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma_{w}\)</span></td>
<td><code>sigma_w</code></td>
<td>0.1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\delta\)</span></td>
<td><code>delta</code></td>
<td>0.05</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li><p>Define the parameter variables as above.</p></li>
<li><p>Write a function that returns the log output given <span class="math inline">\(l_{jt}\)</span>, <span class="math inline">\(k_{jt}\)</span>, <span class="math inline">\(\omega_{jt}\)</span>, and <span class="math inline">\(l_{jt}\)</span> under the given parameter values according to the above production function and name it <code>log_production</code>.</p></li>
</ol>
<p>Suppose that the labor is determined after <span class="math inline">\(\omega_{jt}\)</span> is observed, but before <span class="math inline">\(\eta_{jt}\)</span> is observed, given the log capital level <span class="math inline">\(k_{jt}\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li>Derive the optimal log labor as a function of <span class="math inline">\(\omega_{jt}\)</span>, <span class="math inline">\(\eta_{jt}\)</span>, <span class="math inline">\(k_{jt}\)</span>, and <span class="math inline">\(w_t\)</span>. Write a function to return the optimal log labor given the variables and parameters and name it <code>log_labor_choice</code>.</li>
</ol>
<p>As discussed in the class, if there is no additional variation in labor, the coefficient on the labor <span class="math inline">\(\beta_l\)</span> is not identified. Thus, if we generate labor choice from the previous function, <span class="math inline">\(\beta_l\)</span> will not be identified from the simulated data. To see this, we write a modified version of the previous function in which <span class="math inline">\(\omega_{jt}\)</span> is replaced with <span class="math inline">\(\omega_{jt} + \iota_{jt}\)</span>, where <span class="math inline">\(\iota_{jt}\)</span> is an optimization error that follows an i.i.d. normal distribution with mean 0 and standard deviation 0.05. That is, the manager of the firm perceives as if the shock is <span class="math inline">\(\omega_{jt} + \iota_{jt}\)</span>, even though the true shock is <span class="math inline">\(\omega_{jt}\)</span>.</p>
<ol start="4" style="list-style-type: decimal">
<li>Modify the previous function by including <span class="math inline">\(\iota_{jt}\)</span> as an additional input and name it <code>log_labor_choice_error</code>.</li>
</ol>
<p>Consider an investment process such that: <span class="math display">\[
I_{jt} = (\delta + \gamma w_{jt}) K_{jt},
\]</span> where <span class="math inline">\(I_{jt}\)</span> and <span class="math inline">\(K_{jt}\)</span> are investment and capital in level. Set <span class="math inline">\(\gamma = 0.1\)</span>, i.e., the investment is strictly increasing in <span class="math inline">\(\omega_{jt}\)</span>. The investment function should be derived by solving the dynamic problem of a firm. But here, we just specify it in a reduced-form.</p>
<ol start="5" style="list-style-type: decimal">
<li>Define variable <span class="math inline">\(\gamma\)</span> and assign it the value. Write a function that returns the investment given <span class="math inline">\(K_{jt}\)</span>, <span class="math inline">\(\omega_{jt}\)</span>, and parameter values, according to the previous equation, and name it <code>investment_choice</code>.</li>
</ol>
<p>Simulate the data first using the labor choice without optimization error and second using the labor choice with optimization error. To do so, we specify the initial values for the state variables <span class="math inline">\(k_{jt}\)</span> and <span class="math inline">\(\omega_{jt}\)</span> as follows.</p>
<ol start="6" style="list-style-type: decimal">
<li>Draw <span class="math inline">\(k_{j0}\)</span> from an i.i.d. normal distribution with mean 1 and standard deviation 0.5. Draw <span class="math inline">\(\omega_{j0}\)</span> from its stationary distribution (check the stationary distribution of AR(1) process). Draw a wage. Before simulating the rest of the data, set the seed at 1.</li>
</ol>
<pre><code>## # A tibble: 1,000 x 5
##        j     t     k   omega  wage
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1 1.09   0.779  0.591
##  2     2     1 0.582 -0.610  0.591
##  3     3     1 1.80   0.148  0.591
##  4     4     1 1.16   0.0486 0.591
##  5     5     1 0.590 -1.16   0.591
##  6     6     1 1.24   0.568  0.591
##  7     7     1 1.37  -1.34   0.591
##  8     8     1 1.29  -0.873  0.591
##  9     9     1 0.847  0.699  0.591
## 10    10     1 1.76  -0.379  0.591
## # … with 990 more rows</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Compute the labor and investment choice of period 1. For labor choice, compute both types of labor choices.</li>
</ol>
<pre><code>## # A tibble: 1,000 x 9
##        j     t     k   omega  wage     iota     l l_error       I
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1 1.09   0.779  0.591 -0.0961  6.20    5.50   0.381 
##  2     2     1 0.582 -0.610  0.591  0.0810  0.700   0.775 -0.0196
##  3     3     1 1.80   0.148  0.591  0.0260  5.23    5.40   0.391 
##  4     4     1 1.16   0.0486 0.591 -0.00279 2.65    2.65   0.176 
##  5     5     1 0.590 -1.16   0.591  0.0348  0.352   0.368 -0.120 
##  6     6     1 1.24   0.568  0.591  0.00268 5.44    5.46   0.370 
##  7     7     1 1.37  -1.34   0.591 -0.0655  0.560   0.516 -0.330 
##  8     8     1 1.29  -0.873  0.591 -0.106   0.934   0.818 -0.135 
##  9     9     1 0.847  0.699  0.591 -0.0104  4.53    4.47   0.280 
## 10    10     1 1.76  -0.379  0.591 -0.0156  2.61    2.56   0.0702
## # … with 990 more rows</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Draw ex post shock and compute the output according to the production function for both labor without optimization error and with optimization error.</li>
</ol>
<pre><code>## # A tibble: 1,000 x 12
##        j     t     k   omega  wage     iota     l l_error       I     eta
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1 1.09   0.779  0.591 -0.0961  6.20    5.50   0.381   0.0773
##  2     2     1 0.582 -0.610  0.591  0.0810  0.700   0.775 -0.0196  0.259 
##  3     3     1 1.80   0.148  0.591  0.0260  5.23    5.40   0.391  -0.161 
##  4     4     1 1.16   0.0486 0.591 -0.00279 2.65    2.65   0.176  -0.321 
##  5     5     1 0.590 -1.16   0.591  0.0348  0.352   0.368 -0.120   0.187 
##  6     6     1 1.24   0.568  0.591  0.00268 5.44    5.46   0.370   0.361 
##  7     7     1 1.37  -1.34   0.591 -0.0655  0.560   0.516 -0.330  -0.0113
##  8     8     1 1.29  -0.873  0.591 -0.106   0.934   0.818 -0.135   0.377 
##  9     9     1 0.847  0.699  0.591 -0.0104  4.53    4.47   0.280   0.316 
## 10    10     1 1.76  -0.379  0.591 -0.0156  2.61    2.56   0.0702  0.100 
## # … with 990 more rows, and 2 more variables: y &lt;dbl&gt;, y_error &lt;dbl&gt;</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Repeat this procedure for <span class="math inline">\(t = 1, \cdots 10\)</span> by updating the capital and anticipated shocks, and name the resulting data frame <code>df_T</code>.</li>
</ol>
<pre><code>## # A tibble: 10,000 x 13
##        j     t     k   omega  wage     iota     l l_error       I     eta
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1 1.09   0.779  0.591 -0.0961  6.20    5.50   0.381   0.0773
##  2     2     1 0.582 -0.610  0.591  0.0810  0.700   0.775 -0.0196  0.259 
##  3     3     1 1.80   0.148  0.591  0.0260  5.23    5.40   0.391  -0.161 
##  4     4     1 1.16   0.0486 0.591 -0.00279 2.65    2.65   0.176  -0.321 
##  5     5     1 0.590 -1.16   0.591  0.0348  0.352   0.368 -0.120   0.187 
##  6     6     1 1.24   0.568  0.591  0.00268 5.44    5.46   0.370   0.361 
##  7     7     1 1.37  -1.34   0.591 -0.0655  0.560   0.516 -0.330  -0.0113
##  8     8     1 1.29  -0.873  0.591 -0.106   0.934   0.818 -0.135   0.377 
##  9     9     1 0.847  0.699  0.591 -0.0104  4.53    4.47   0.280   0.316 
## 10    10     1 1.76  -0.379  0.591 -0.0156  2.61    2.56   0.0702  0.100 
## # … with 9,990 more rows, and 3 more variables: y &lt;dbl&gt;, y_error &lt;dbl&gt;,
## #   nu &lt;dbl&gt;</code></pre>
<ol start="10" style="list-style-type: decimal">
<li><p>Check the simulated data by making summary table.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">N</th>
<th align="center">Mean</th>
<th align="center">Sd</th>
<th align="center">Min</th>
<th align="center">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>j</td>
<td align="center">10000</td>
<td align="center">500.5000000</td>
<td align="center">288.6894251</td>
<td align="center">1.0000000</td>
<td align="center">1000.0000000</td>
</tr>
<tr class="even">
<td>t</td>
<td align="center">10000</td>
<td align="center">5.5000000</td>
<td align="center">2.8724249</td>
<td align="center">1.0000000</td>
<td align="center">10.0000000</td>
</tr>
<tr class="odd">
<td>k</td>
<td align="center">10000</td>
<td align="center">0.9809540</td>
<td align="center">0.5827349</td>
<td align="center">-1.2846624</td>
<td align="center">3.4715184</td>
</tr>
<tr class="even">
<td>omega</td>
<td align="center">10000</td>
<td align="center">-0.0042518</td>
<td align="center">0.6947047</td>
<td align="center">-2.4722527</td>
<td align="center">2.5482112</td>
</tr>
<tr class="odd">
<td>wage</td>
<td align="center">10000</td>
<td align="center">1.2999738</td>
<td align="center">1.0034241</td>
<td align="center">0.2412463</td>
<td align="center">2.9228370</td>
</tr>
<tr class="even">
<td>iota</td>
<td align="center">10000</td>
<td align="center">-0.0000634</td>
<td align="center">0.0502874</td>
<td align="center">-0.1841453</td>
<td align="center">0.1715419</td>
</tr>
<tr class="odd">
<td>l</td>
<td align="center">10000</td>
<td align="center">3.9635027</td>
<td align="center">8.0655395</td>
<td align="center">0.0095922</td>
<td align="center">139.0681340</td>
</tr>
<tr class="even">
<td>l_error</td>
<td align="center">10000</td>
<td align="center">3.9729395</td>
<td align="center">8.1144243</td>
<td align="center">0.0095479</td>
<td align="center">151.8869846</td>
</tr>
<tr class="odd">
<td>I</td>
<td align="center">10000</td>
<td align="center">0.1801717</td>
<td align="center">0.3180590</td>
<td align="center">-1.3075169</td>
<td align="center">5.9394281</td>
</tr>
<tr class="even">
<td>eta</td>
<td align="center">10000</td>
<td align="center">0.0012772</td>
<td align="center">0.1999334</td>
<td align="center">-0.7650371</td>
<td align="center">0.7455922</td>
</tr>
<tr class="odd">
<td>y</td>
<td align="center">10000</td>
<td align="center">2.4763938</td>
<td align="center">2.1954979</td>
<td align="center">-1.6282224</td>
<td align="center">32.1811842</td>
</tr>
<tr class="even">
<td>y_error</td>
<td align="center">10000</td>
<td align="center">2.4782811</td>
<td align="center">2.2032667</td>
<td align="center">-1.6281667</td>
<td align="center">34.5350569</td>
</tr>
<tr class="odd">
<td>nu</td>
<td align="center">10000</td>
<td align="center">-0.0013588</td>
<td align="center">0.4990855</td>
<td align="center">-2.1513907</td>
<td align="center">1.8253882</td>
</tr>
</tbody>
</table></li>
</ol>
</div>
<div id="estimate-the-parameters" class="section level2">
<h2><span class="header-section-number">5.2</span> Estimate the parameters</h2>
<p>For now, use the labor choice with optimization error.</p>
<ol style="list-style-type: decimal">
<li>First, simply regress <span class="math inline">\(y_{jt}\)</span> on <span class="math inline">\(l_{jt}\)</span> and <span class="math inline">\(k_{jt}\)</span> using the least square method. This is likely to give an upwardly biased estimates on <span class="math inline">\(\beta_l\)</span> and <span class="math inline">\(\beta_k\)</span>. Why is it?</li>
</ol>
<pre><code>## 
## Call:
## lm(formula = y_error ~ l_error + k, data = df_T)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8221 -0.4208  0.0063  0.4281  2.2634 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.793901   0.012732   62.35   &lt;2e-16 ***
## l_error     0.236968   0.000845  280.44   &lt;2e-16 ***
## k           0.757343   0.011766   64.37   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.65 on 9997 degrees of freedom
## Multiple R-squared:  0.913,  Adjusted R-squared:  0.913 
## F-statistic: 5.244e+04 on 2 and 9997 DF,  p-value: &lt; 2.2e-16</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Second, take within-transformation on <span class="math inline">\(y_{jt}\)</span>, <span class="math inline">\(l_{jt}\)</span>, and <span class="math inline">\(k_{jt}\)</span> and let <span class="math inline">\(\Delta y_{jt}\)</span>, <span class="math inline">\(\Delta l_{jt}\)</span>, and <span class="math inline">\(\Delta k_{jt}\)</span> denote them. Then, regress <span class="math inline">\(\Delta y_{jt}\)</span> on <span class="math inline">\(\Delta l_{jt}\)</span>, and <span class="math inline">\(\Delta k_{jt}\)</span> by the least squares method.</li>
</ol>
<pre><code>## 
## Call:
## lm(formula = dy_error ~ -1 + dl_error + dk, data = df_T_within)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.45979 -0.34453 -0.00146  0.34631  1.98491 
## 
## Coefficients:
##           Estimate Std. Error t value Pr(&gt;|t|)    
## dl_error 0.2256116  0.0007631 295.667   &lt;2e-16 ***
## dk       0.0168781  0.0348015   0.485    0.628    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5264 on 9998 degrees of freedom
## Multiple R-squared:  0.8974, Adjusted R-squared:  0.8974 
## F-statistic: 4.373e+04 on 2 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Next, we attempt to estimate the parameters using Olley-Pakes method. Estimate the first-step model of Olley-Pakes method: <span class="math display">\[
y_{jt} = \beta_0 + \beta_1 l_{jt} + \phi(k_{jt}, I_{jt}) + \eta_{jt},
\]</span> by approximating <span class="math inline">\(\phi_t\)</span> by a kernel function.</p>
<p>Remark that <span class="math inline">\(\phi\)</span> in general depends on observed and unobserved state variables. For this reason, in theory, <span class="math inline">\(\phi\)</span> should be estimated for each period. In this exercise, we assume <span class="math inline">\(\phi\)</span> is common across periods because we know that there is no unobserved state variables in the true data generating process. Moreover, we do not include <span class="math inline">\(w_t\)</span> because we know that it is i.i.d. in the true data generating process. Do not forget to consider them in the actual data analysis.</p>
<p>You can use <code>npplreg</code> function of <code>np</code> package to estimate a partially linear model with a multivariate kernel. You first use <code>npplregbw</code> to obtain the optimal band width and then use <code>npplreg</code> to estimate the model under the optimal bandwidth. The computation of the optimal bandwidth is time consuming.</p>
<ol start="3" style="list-style-type: decimal">
<li>Return the summary of the first stage estimation and plot the fitted values against the data points.</li>
</ol>
<pre><code>## 
## Partially Linear Model
## Regression data: 10000 training points, in 5 variable(s)
## With 3 linear parametric regressor(s), 2 nonparametric regressor(s)
## 
##                     y(z)           
## Bandwidth(s): 0.08208261 0.07116851
## 
##                      x(z)             
## Bandwidth(s): 0.093082611 9.482612e-02
##               0.008783221 2.232608e+06
##               0.805988383 4.831148e-02
## 
##                   l_error         k        I
## Coefficient(s): 0.1957426 -7.135889 8.365059
## 
## Kernel Regression Estimator: Local-Constant
## Bandwidth Type: Fixed
## 
## Residual standard error: 0.2414186
## R-squared: 0.9882013
## 
## Continuous Kernel Type: Second-Order Gaussian
## No. Continuous Explanatory Vars.: 2</code></pre>
<p><img src="lecture_files/figure-html/unnamed-chunk-48-1.png" width="672" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Check that <span class="math inline">\(\beta_l\)</span> is not identified with the data without optimization error. Estimate the first stage model of Olley-Pakes with the labor choice without optimization error and report the result.</li>
</ol>
<pre><code>## 
## Partially Linear Model
## Regression data: 10000 training points, in 5 variable(s)
## With 3 linear parametric regressor(s), 2 nonparametric regressor(s)
## 
##                    y(z)           
## Bandwidth(s): 0.2245037 0.02527988
## 
##                       x(z)            
## Bandwidth(s): 2.854165e-01 0.127411417
##               1.107858e-02 0.472389899
##               2.725632e+05 0.006739356
## 
##                         l        k         I
## Coefficient(s): 0.1787756 1.082508 -56.73451
## 
## Kernel Regression Estimator: Local-Constant
## Bandwidth Type: Fixed
## 
## Residual standard error: 0.3470795
## R-squared: 0.9764468
## 
## Continuous Kernel Type: Second-Order Gaussian
## No. Continuous Explanatory Vars.: 2</code></pre>
<p>Then, we estimate the second stage model of Olley-Pakes method: <span class="math display">\[
y_{jt} - \hat{\beta_l} l_{jt} = \beta_0 + \beta_k k_{jt} + \alpha[\hat{\phi}(k_{j, t - 1}, I_{j, t - 1}) - \beta_0 - \beta_k k_{jt}] + \nu_{jt} + \eta_{jt}.
\]</span></p>
<p>In this model, we do not have to non-parametetrically estimate the conditional expectation of <span class="math inline">\(\omega_{jt}\)</span> on <span class="math inline">\(\omega_{j, t - 1}\)</span>, because we know that the anticipated shock follows an AR(1) process. Remark that we in general have to non-parametrically estimate it.</p>
<p>The model is non-linear in parameters, because of the term <span class="math inline">\(\alpha \beta_0\)</span> and <span class="math inline">\(\alpha \beta_k\)</span>. We estimate <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta_0\)</span>, and <span class="math inline">\(\beta_k\)</span> by a GMM estimator. The moment is: <span class="math display">\[
g_{JT}(\alpha, \beta_0, \beta_k) \equiv \frac{1}{JT}\sum_{j = 1}^J \sum_{t = 1}^T \{y_{jt} - \hat{\beta_l} l_{jt} - \beta_0 - \beta_k k_{jt} - \alpha[\hat{\phi}(k_{j, t - 1}, I_{j, t - 1}) - \beta_0 - \beta_k k_{jt}]\} 
\begin{bmatrix}
k_{jt} \\
k_{j, t - 1} \\
I_{j, t - 1}
\end{bmatrix}.
\]</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Using the estimates in the first step, compute: <span class="math display">\[
y_{jt} - \hat{\beta_l} l_{jt},
\]</span> and: <span class="math display">\[
\hat{\phi}(k_{j, t - 1}, I_{j, t - 1}),
\]</span> for each <span class="math inline">\(j\)</span> and <span class="math inline">\(t\)</span> and save it as a data frame names <code>df_T_1st</code>.</li>
</ol>
<pre><code>## # A tibble: 10,000 x 4
##        j     t y_error_tilde phi_t_1
##    &lt;int&gt; &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1          2.64  NA    
##  2     1     2          2.22   2.62 
##  3     1     3          3.13   2.73 
##  4     1     4          2.50   3.21 
##  5     1     5          3.08   2.58 
##  6     1     6          2.16   3.17 
##  7     1     7          1.30   2.54 
##  8     1     8          1.17   1.40 
##  9     1     9          1.88   0.851
## 10     1    10          1.87   1.56 
## # … with 9,990 more rows</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Compute a function that returns the value of <span class="math inline">\(g_{JT}(\alpha, \beta_0, \beta_k)\)</span> given parameter values, data, and <code>df_T_1st</code>, and name it <code>moment_OP_2nd</code>. Show the values of the first five rows of the moment evaluated at the true parameters.</li>
</ol>
<pre><code>## [1] -0.007100535 -0.006621758 -0.009029895</code></pre>
<p>Based on the moment, we can define the objective function of a generalized method of moments estimator with a weighting matrix <span class="math inline">\(W\)</span> as: <span class="math display">\[
Q_{JT}(\alpha, \beta_0, \beta_k) \equiv g_{JT}(\alpha, \beta_0, \beta_k)&#39; W g_{JT}(\alpha, \beta_0, \beta_k).
\]</span></p>
<ol start="7" style="list-style-type: decimal">
<li>Write a function that returns the value of <span class="math inline">\(Q_{JT}(\alpha, \beta_0, \beta_k)\)</span> given the vector of parameter values, data, and <code>df_T_1st</code>, and name it <code>objective_OP_2nd</code>. Setting <span class="math inline">\(W\)</span> at the identity matrix, show the value of the objective function evaluated at the true parameters.</li>
</ol>
<pre><code>##              [,1]
## [1,] 0.0001758043</code></pre>
<ol start="8" style="list-style-type: decimal">
<li><p>Draw the graph of the objective function when one of <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta_0\)</span>, and <span class="math inline">\(\beta_k\)</span> are changed from 0 to 1 by 0.1 while the others are set at the true value. Is the objective function minimized at around the true value? <img src="lecture_files/figure-html/unnamed-chunk-55-1.png" width="672" style="display: block; margin: auto;" /><img src="lecture_files/figure-html/unnamed-chunk-55-2.png" width="672" style="display: block; margin: auto;" /><img src="lecture_files/figure-html/unnamed-chunk-55-3.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Find the parameters that minimize the objective function using <code>optim</code>. You may use <code>L-BFGS-B</code> method to solve it.</p></li>
</ol>
<pre><code>## $par
## [1] 0.6539508 1.0021382 0.6968459
## 
## $value
## [1] 1.720679e-06
## 
## $counts
## function gradient 
##       11       11 
## 
## $convergence
## [1] 0
## 
## $message
## [1] &quot;CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH&quot;</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="assignment1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["lecture.pdf", "lecture.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
