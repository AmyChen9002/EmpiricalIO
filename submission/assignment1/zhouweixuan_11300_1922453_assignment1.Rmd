---
title: "assignment1"
author: "weixuan"
date: "2019年2月12日"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
#part 1
library(extRemes)
set.seed(1)
i=rep(1:1000,each=2)
k=1:2
x=0:1
e=revd(2000)
latent=e+x*0.2
#I calculate y based on whether the observation is even number or odd number. For even number observations, I compare the latent value with the one above it; for odd number observaations, I compare the latent value with the one below it
y=0
df=data.frame(i,k,x,e,latent,y)
z=1
while (z<2001){
  if (z%%2>0.5){
    if (df[z,5]>df[z+1,5]){
      df[z,6]=1
    }
  }
  if (z%%2<0.5){
    if (df[z,5]>df[z-1,5]){
      df[z,6]=1
    }
  }
  z<-z+1
}
df
source("R/functions.R")
b=seq(from=0,to=1,by=0.1)
Loglikelihood=seq(from=0,to=1,by=0.1)
for (j in seq(1,11,1)){
  Loglikelihood[j]=loglikelihood_A1(b[j])
}
library(latex2exp)
ggplot2::qplot(b,Loglikelihood,xlab=expression(beta))
#The optim function calculates local minimizer, but I want maximizer. So I use a reverse function to reverse the sign
optim(par=0,fn=reverse,method="Brent",lower=-1,upper=1)
#Remark: I got a slightly different beta probably due to numerical rounding. I calculate log-likelihood value is around 1,000 times as the one shown on the course website. I think the course website value is the AVERAGE log-likelihood value with respect to i, since the number of i is exactly 1,000

```

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
