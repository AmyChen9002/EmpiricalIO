---
title: "assignment1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Simulate data

I consider to simulate data from the following model and estimate the parameters from the simulated data.
<br/>$y_{ij}=1\{j=argmax_{k=1,2}\beta x_{k}+\epsilon_{ik}\}$,</br>
<br/>where$\epsilon_{ik}$follows i.i.d. type-I extreme value distribution,$\beta=0.2$, $x_{1}=0$ and $x_{2}=1$.
<br/>1.To simulate data, firstly, I make a data frame as follows:</br>

```{r echo=FALSE}
i<-rep(1:1000, each=2)
k<-rep(1:2, times=1000)
x<-rep(0:1, times=1000)
library(tibble)
t1<-tibble("i" = i, "k" = k, "x" = x);t1

```


<br/>2. Second, I draw type-I extreme value random variables. The seed is 1.</br>

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(extRemes)

set.seed(1) 
e<-revd(2000, 0, 1) 
t2<-add_column(t1, e);t2
```


<br/>3. Third, the latent value of each option is computed and combined in the following data frame:</br>

```{r echo=FALSE, message=FALSE, warning=FALSE}
latent=0.2*x+e
t3<-add_column(t2, latent);t3
```

<br/>4. Finally, I compute $y$ by comparing the latent values of $k=1,2$ for each $i$ to obtain the following result:</br>

```{r echo=FALSE, message=FALSE, warning=FALSE}
y<-rep(1,2000); num<-seq(2,2000,2)
for(i in num){
  y[i]=as.numeric(latent[i]>latent[i-1])
  y[i-1]=1-y[i]
}
t4<-add_column(t3, y);t4
```



## Estimate the parameter

1. After generating the simulated data, I write a function to compute the livelihood for a given $\beta$ and data and name the function loglikelihood_A1. This function is written in a separate **R** file named "functions" which in R folder in my project folder named "assignment". Then I build the project as a package and load it to ompute the value of log likelihood for $\beta = 0, 0.1, \cdots, 1$ and plot the result using ggplot2 packages.



```{r echo=FALSE, message=FALSE, warning=FALSE}
library(assignment)
library(ggplot2)

#install.packages('latex2exp')
library(latex2exp)

bta<-seq(0,1,0.1)
qplot(bta,loglikelihood_A1(bta,t4),xlab=TeX('$\\beta'), ylab="Loglikelihood")
```

2.I find and report $\beta$ that maximizes the log likelihood for the simulated data. For the parameter search, I set the lower bound at -1 and upper bound at 1.



```{r echo=FALSE, message=FALSE, warning=FALSE}
maxf<-function(beta){loglikelihood_A1(beta=beta,t=t4)}
optim(par=0, maxf ,method = "Brent", control = list(fnscale = -1),lower =-1, upper = 1)
```

