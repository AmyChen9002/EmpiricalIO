---
title: "assignment1"
author: Lin ZHAO
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE,eval= FALSE}
install.packages("tidyverse")
ibrary(tidyverse)
# tidyverse is a package contains tibble, pplot2,dplyr,tidyr, purrr, also can use a smaller package:
install.packages("tibble")
library(tibble)
install.packages("evd")
library(evd)
install.packages("extRemes")
library(extRemes)
knitr::opts_chunk$set(echo = TRUE)
```

##4.1 Simulate Date
```{r}
beta = 0.2
x_1 = 0
x_2 = 1 
```
 
###Step 1:
To simulate data, first make a data frame inculding i, k,x
```{r}
i <- as.integer(gl(1000, 2))  # change the type of variable into integer
k <- rep(1:2,1000)
x <- rep_len(c(0,1), 2000)
t1<-tibble::tibble(i, k, x)
t1
```


###Step 2: 
draw type-I extreme value random variables. Set the seed at 1. You can use evd package to
draw the variables: can either use rgumbel funtion or revd funtion.

```{r}
# install.packages("evd")
library(evd)
# install.packages("extRemes")
library(extRemes)
set.seed(1)
e <- revd(2000, loc = 0, scale = 1, shape = 0)
set.seed(1)
library(evd)
e <- revd(2000, loc = 0, scale = 1, shape = 0)
t2<-tibble::tibble(i, k, x, e)
t2
```

###Step 3
Compute the latent value of each option:
```{r}
latent= beta*x +e
t3<-tibble::tibble(i, k, x, e, latent)
t3
```
###Step 4
Compute y by comparing the latent values of k = 1, 2 for each i:
```{r}
y = rep(0,2000)
for(m in i){
  y_1 <- t3[m*2-1,5]
  y_2 <- t3[m*2,5]
  if(y_1 > y_2)
    y[m*2-1]<- 1
  else
    y[m*2]<- 1
}
t4<-tibble::tibble(i, k, x, e,latent, y)
t4
```

##4.2 Estimate the parameter
```{r pressure, echo=FALSE}
source("R/loglikelihood_A1.R")

bb<- seq(0, 1, 0.1)
Loglikelihood=rep(1,length(bb))
m=1
for(b in bb){
  Loglikelihood[m]=loglikelihood_A1(b)
m<- m+1
if(m > length(bb)){break}
}
library(latex2exp)
library(ggplot2)
ggplot2::qplot(bb,Loglikelihood,aes(x=bb, y=Loglikelihood))+xlab(TeX("$\\beta"))+ylab(TeX('Likelihood'))
                                       
    
```

###find the beta maximizes loglikelihood similated beta

```{r}
fn <- function(beta_hat) {
  y <- -loglikelihood_A1(beta_hat)
  return(y)
}

optim(par = 0, fn, method = c("Brent"),lower = -1, upper = 1)
```



